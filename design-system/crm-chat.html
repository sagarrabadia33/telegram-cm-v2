<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Telegram CRM</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="tokens.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    /* ============================================
     * LAYOUT
     * ============================================ */
    .app {
      display: flex;
      height: 100vh;
      background: var(--bg-primary);
    }

    .panel {
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    /* Left Panel - Conversations */
    .panel-conversations {
      width: 320px;
      min-width: 280px;
      max-width: 400px;
      border-right: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    /* Middle Panel - Messages */
    .panel-messages {
      flex: 1;
      min-width: 400px;
      background: var(--bg-primary);
    }

    /* Right Panel - AI Assistant */
    .panel-assistant {
      width: 360px;
      min-width: 300px;
      max-width: 480px;
      border-left: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    /* Resizer */
    .resizer {
      width: 4px;
      cursor: col-resize;
      background: transparent;
      transition: background var(--transition-base);
      position: relative;
    }

    .resizer:hover,
    .resizer.active {
      background: var(--accent-primary);
    }

    .resizer::before {
      content: '';
      position: absolute;
      top: 0;
      left: -4px;
      right: -4px;
      bottom: 0;
    }

    /* ============================================
     * PANEL HEADER
     * ============================================ */
    .panel-header {
      padding: var(--space-4);
      border-bottom: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    .panel-title {
      font-size: var(--title-md);
      font-weight: var(--font-semibold);
      color: var(--text-primary);
      margin-bottom: var(--space-3);
    }

    /* ============================================
     * SEARCH
     * ============================================ */
    .search-wrapper {
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: var(--space-3);
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-quaternary);
      pointer-events: none;
    }

    .search-input {
      width: 100%;
      height: 36px;
      padding: 0 var(--space-3) 0 var(--space-10);
      font-family: var(--font-sans);
      font-size: var(--text-sm);
      color: var(--text-primary);
      background: var(--bg-tertiary);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-md);
      outline: none;
      transition: all var(--transition-base);
    }

    .search-input::placeholder {
      color: var(--text-quaternary);
    }

    .search-input:focus {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 2px var(--accent-subtle);
    }

    /* ============================================
     * CONVERSATIONS LIST
     * ============================================ */
    .conversations-list {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-2);
    }

    .conversation-item {
      display: flex;
      align-items: flex-start;
      gap: var(--space-3);
      padding: var(--space-3);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: background var(--transition-base);
      margin-bottom: var(--space-1);
    }

    .conversation-item:hover {
      background: var(--bg-hover);
    }

    .conversation-item.active {
      background: var(--bg-tertiary);
    }

    .conversation-avatar {
      width: 44px;
      height: 44px;
      border-radius: var(--radius-full);
      background: var(--accent-subtle);
      color: var(--accent-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: var(--font-semibold);
      font-size: var(--text-md);
      flex-shrink: 0;
    }

    .conversation-avatar.online::after {
      content: '';
      position: absolute;
      bottom: 2px;
      right: 2px;
      width: 10px;
      height: 10px;
      background: var(--success);
      border: 2px solid var(--bg-secondary);
      border-radius: var(--radius-full);
    }

    .conversation-avatar-wrapper {
      position: relative;
    }

    .conversation-content {
      flex: 1;
      min-width: 0;
      overflow: hidden;
    }

    .conversation-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-2);
      margin-bottom: var(--space-1);
    }

    .conversation-name {
      font-size: var(--text-md);
      font-weight: var(--font-medium);
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .conversation-time {
      font-size: var(--text-xs);
      color: var(--text-quaternary);
      flex-shrink: 0;
    }

    .conversation-preview {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .conversation-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: var(--space-1);
    }

    .conversation-source {
      font-size: var(--text-xs);
      color: var(--text-quaternary);
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .unread-badge {
      min-width: 20px;
      height: 20px;
      padding: 0 var(--space-1-5);
      background: var(--accent-primary);
      color: white;
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ============================================
     * MESSAGE PANEL
     * ============================================ */
    .message-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-4);
      border-bottom: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    .message-header-left {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .message-header-avatar {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--accent-subtle);
      color: var(--accent-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: var(--font-semibold);
    }

    .message-header-info {
      display: flex;
      flex-direction: column;
    }

    .message-header-name {
      font-size: var(--title-sm);
      font-weight: var(--font-semibold);
      color: var(--text-primary);
    }

    .message-header-status {
      font-size: var(--text-xs);
      color: var(--text-tertiary);
    }

    .message-header-actions {
      display: flex;
      gap: var(--space-2);
    }

    .icon-btn {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      color: var(--text-tertiary);
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .icon-btn:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    /* Messages Container */
    .messages-container {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-4);
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .message-group {
      display: flex;
      flex-direction: column;
      gap: var(--space-1);
    }

    .message-date-divider {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-4) 0;
    }

    .message-date-divider span {
      font-size: var(--text-xs);
      color: var(--text-quaternary);
      background: var(--bg-primary);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      border: 1px solid var(--border-subtle);
    }

    .message {
      max-width: 70%;
      display: flex;
      flex-direction: column;
    }

    .message.received {
      align-self: flex-start;
    }

    .message.sent {
      align-self: flex-end;
    }

    .message-bubble {
      padding: var(--space-3) var(--space-4);
      border-radius: var(--radius-lg);
      font-size: var(--text-md);
      line-height: 1.5;
    }

    .message.received .message-bubble {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-bottom-left-radius: var(--radius-sm);
    }

    .message.sent .message-bubble {
      background: var(--accent-primary);
      color: white;
      border-bottom-right-radius: var(--radius-sm);
    }

    .message-time {
      font-size: var(--text-xs);
      color: var(--text-quaternary);
      margin-top: var(--space-1);
    }

    .message.sent .message-time {
      text-align: right;
    }

    .message-status {
      display: inline-flex;
      align-items: center;
      gap: var(--space-1);
    }

    /* Typing Indicator */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      padding: var(--space-2) 0;
    }

    .typing-dots {
      display: flex;
      gap: 4px;
    }

    .typing-dots span {
      width: 8px;
      height: 8px;
      background: var(--text-quaternary);
      border-radius: var(--radius-full);
      animation: typing 1.4s infinite;
    }

    .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
    .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
      30% { transform: translateY(-4px); opacity: 1; }
    }

    /* Message Input */
    .message-input-container {
      padding: var(--space-4);
      border-top: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    .message-input-wrapper {
      display: flex;
      align-items: flex-end;
      gap: var(--space-3);
      background: var(--bg-tertiary);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-lg);
      padding: var(--space-2) var(--space-3);
      transition: all var(--transition-base);
    }

    .message-input-wrapper:focus-within {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 2px var(--accent-subtle);
    }

    .message-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-family: var(--font-sans);
      font-size: var(--text-md);
      color: var(--text-primary);
      resize: none;
      min-height: 24px;
      max-height: 120px;
      line-height: 1.5;
    }

    .message-input::placeholder {
      color: var(--text-quaternary);
    }

    .message-input-actions {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .send-btn {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--accent-primary);
      border: none;
      border-radius: var(--radius-md);
      color: white;
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .send-btn:hover {
      background: var(--accent-hover);
    }

    .send-btn:disabled {
      background: var(--bg-hover);
      color: var(--text-quaternary);
      cursor: not-allowed;
    }

    /* ============================================
     * AI ASSISTANT PANEL
     * ============================================ */
    .assistant-header {
      padding: var(--space-4);
      border-bottom: 1px solid var(--border-subtle);
    }

    .assistant-title {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: var(--title-md);
      font-weight: var(--font-semibold);
      color: var(--text-primary);
    }

    .assistant-title svg {
      color: var(--accent-primary);
    }

    .assistant-subtitle {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
      margin-top: var(--space-1);
    }

    .assistant-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-4);
    }

    /* Quick Actions */
    .quick-actions {
      margin-bottom: var(--space-6);
    }

    .quick-actions-title {
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
      color: var(--text-quaternary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-uppercase);
      margin-bottom: var(--space-3);
    }

    .quick-action-btn {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      width: 100%;
      padding: var(--space-3);
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      color: var(--text-secondary);
      font-size: var(--text-sm);
      cursor: pointer;
      transition: all var(--transition-base);
      margin-bottom: var(--space-2);
      text-align: left;
    }

    .quick-action-btn:hover {
      background: var(--bg-hover);
      border-color: var(--border-default);
    }

    .quick-action-btn svg {
      color: var(--text-tertiary);
      flex-shrink: 0;
    }

    /* Contact Info */
    .contact-info {
      background: var(--bg-tertiary);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      margin-bottom: var(--space-6);
    }

    .contact-info-title {
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
      color: var(--text-quaternary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-uppercase);
      margin-bottom: var(--space-3);
    }

    .contact-info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-2) 0;
      border-bottom: 1px solid var(--border-subtle);
    }

    .contact-info-row:last-child {
      border-bottom: none;
    }

    .contact-info-label {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
    }

    .contact-info-value {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: var(--font-medium);
    }

    /* AI Chat */
    .ai-chat {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .ai-message {
      padding: var(--space-3);
      background: var(--bg-tertiary);
      border-radius: var(--radius-lg);
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .ai-message.user {
      background: var(--accent-subtle);
      color: var(--text-primary);
    }

    .ai-suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
      margin-top: var(--space-3);
    }

    .ai-suggestion {
      padding: var(--space-2) var(--space-3);
      background: var(--bg-secondary);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .ai-suggestion:hover {
      background: var(--bg-hover);
      border-color: var(--accent-primary);
      color: var(--accent-primary);
    }

    /* Assistant Input */
    .assistant-input-container {
      padding: var(--space-4);
      border-top: 1px solid var(--border-subtle);
    }

    .assistant-input-wrapper {
      display: flex;
      gap: var(--space-2);
    }

    .assistant-input {
      flex: 1;
      height: 36px;
      padding: 0 var(--space-3);
      font-family: var(--font-sans);
      font-size: var(--text-sm);
      color: var(--text-primary);
      background: var(--bg-tertiary);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-md);
      outline: none;
      transition: all var(--transition-base);
    }

    .assistant-input::placeholder {
      color: var(--text-quaternary);
    }

    .assistant-input:focus {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 2px var(--accent-subtle);
    }

    /* ============================================
     * SCROLLBAR
     * ============================================ */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-default);
      border-radius: var(--radius-full);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--border-strong);
    }

    /* ============================================
     * EMPTY STATE
     * ============================================ */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      padding: var(--space-8);
      text-align: center;
    }

    .empty-state-icon {
      width: 64px;
      height: 64px;
      background: var(--bg-secondary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: var(--space-4);
      color: var(--text-quaternary);
    }

    .empty-state-title {
      font-size: var(--title-md);
      font-weight: var(--font-semibold);
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }

    .empty-state-text {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
      max-width: 280px;
    }

    /* ============================================
     * RESPONSIVE
     * ============================================ */
    @media (max-width: 1200px) {
      .panel-assistant {
        display: none;
      }
    }

    @media (max-width: 768px) {
      .panel-conversations {
        width: 100%;
        max-width: 100%;
        position: absolute;
        z-index: 10;
        transform: translateX(0);
        transition: transform var(--transition-slow);
      }

      .panel-conversations.hidden {
        transform: translateX(-100%);
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Left Panel - Conversations -->
    <div class="panel panel-conversations" id="conversationsPanel">
      <div class="panel-header">
        <h1 class="panel-title">Messages</h1>
        <div class="search-wrapper">
          <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <input type="text" class="search-input" placeholder="Search conversations..." id="searchInput">
        </div>
      </div>
      <div class="conversations-list" id="conversationsList">
        <!-- Conversations will be populated by JavaScript -->
      </div>
    </div>

    <!-- Resizer -->
    <div class="resizer" id="resizer1"></div>

    <!-- Middle Panel - Messages -->
    <div class="panel panel-messages" id="messagesPanel">
      <div class="message-header" id="messageHeader">
        <div class="message-header-left">
          <div class="message-header-avatar" id="headerAvatar">SR</div>
          <div class="message-header-info">
            <div class="message-header-name" id="headerName">Select a conversation</div>
            <div class="message-header-status" id="headerStatus">No conversation selected</div>
          </div>
        </div>
        <div class="message-header-actions">
          <button class="icon-btn" title="Voice Call">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
          </button>
          <button class="icon-btn" title="Video Call">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m22 8-6 4 6 4V8Z"></path>
              <rect width="14" height="12" x="2" y="6" rx="2" ry="2"></rect>
            </svg>
          </button>
          <button class="icon-btn" title="More Options">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="1"></circle>
              <circle cx="19" cy="12" r="1"></circle>
              <circle cx="5" cy="12" r="1"></circle>
            </svg>
          </button>
        </div>
      </div>

      <div class="messages-container" id="messagesContainer">
        <div class="empty-state">
          <div class="empty-state-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
          </div>
          <h3 class="empty-state-title">Select a conversation</h3>
          <p class="empty-state-text">Choose a conversation from the left panel to start messaging</p>
        </div>
      </div>

      <div class="message-input-container">
        <div class="message-input-wrapper">
          <button class="icon-btn" title="Attach File">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
            </svg>
          </button>
          <textarea class="message-input" id="messageInput" placeholder="Type a message..." rows="1"></textarea>
          <div class="message-input-actions">
            <button class="icon-btn" title="Emoji">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                <line x1="9" x2="9.01" y1="9" y2="9"></line>
                <line x1="15" x2="15.01" y1="9" y2="9"></line>
              </svg>
            </button>
            <button class="send-btn" id="sendBtn" title="Send Message" disabled>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m22 2-7 20-4-9-9-4Z"></path>
                <path d="M22 2 11 13"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Resizer -->
    <div class="resizer" id="resizer2"></div>

    <!-- Right Panel - AI Assistant -->
    <div class="panel panel-assistant" id="assistantPanel">
      <div class="assistant-header">
        <div class="assistant-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 8V4H8"></path>
            <rect width="16" height="12" x="4" y="8" rx="2"></rect>
            <path d="M2 14h2"></path>
            <path d="M20 14h2"></path>
            <path d="M15 13v2"></path>
            <path d="M9 13v2"></path>
          </svg>
          AI Assistant
        </div>
        <div class="assistant-subtitle">Powered by Claude</div>
      </div>

      <div class="assistant-content" id="assistantContent">
        <!-- Quick Actions -->
        <div class="quick-actions">
          <div class="quick-actions-title">Quick Actions</div>
          <button class="quick-action-btn" onclick="handleQuickAction('summarize')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14,2 14,8 20,8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            Summarize conversation
          </button>
          <button class="quick-action-btn" onclick="handleQuickAction('draft')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 20h9"></path>
              <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"></path>
            </svg>
            Draft a reply
          </button>
          <button class="quick-action-btn" onclick="handleQuickAction('sentiment')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
              <line x1="9" x2="9.01" y1="9" y2="9"></line>
              <line x1="15" x2="15.01" y1="9" y2="9"></line>
            </svg>
            Analyze sentiment
          </button>
          <button class="quick-action-btn" onclick="handleQuickAction('tasks')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="5" width="6" height="6" rx="1"></rect>
              <path d="m3 17 2 2 4-4"></path>
              <path d="M13 6h8"></path>
              <path d="M13 12h8"></path>
              <path d="M13 18h8"></path>
            </svg>
            Extract action items
          </button>
        </div>

        <!-- Contact Info -->
        <div class="contact-info" id="contactInfo">
          <div class="contact-info-title">Contact Details</div>
          <div class="contact-info-row">
            <span class="contact-info-label">Phone</span>
            <span class="contact-info-value" id="contactPhone">-</span>
          </div>
          <div class="contact-info-row">
            <span class="contact-info-label">Email</span>
            <span class="contact-info-value" id="contactEmail">-</span>
          </div>
          <div class="contact-info-row">
            <span class="contact-info-label">Source</span>
            <span class="contact-info-value" id="contactSource">Telegram</span>
          </div>
          <div class="contact-info-row">
            <span class="contact-info-label">First Contact</span>
            <span class="contact-info-value" id="contactFirstDate">-</span>
          </div>
          <div class="contact-info-row">
            <span class="contact-info-label">Total Messages</span>
            <span class="contact-info-value" id="contactTotalMessages">-</span>
          </div>
        </div>

        <!-- AI Chat Messages -->
        <div class="ai-chat" id="aiChat">
          <div class="ai-message">
            <strong>Hello!</strong> I'm your AI assistant. I can help you with:
            <ul style="margin-top: 8px; padding-left: 20px;">
              <li>Summarizing conversations</li>
              <li>Drafting replies</li>
              <li>Analyzing customer sentiment</li>
              <li>Extracting action items</li>
            </ul>
            <div class="ai-suggestions">
              <span class="ai-suggestion" onclick="handleQuickAction('help')">How can you help?</span>
              <span class="ai-suggestion" onclick="handleQuickAction('summarize')">Summarize this chat</span>
            </div>
          </div>
        </div>
      </div>

      <div class="assistant-input-container">
        <div class="assistant-input-wrapper">
          <input type="text" class="assistant-input" id="assistantInput" placeholder="Ask AI anything...">
          <button class="send-btn" id="assistantSendBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m22 2-7 20-4-9-9-4Z"></path>
              <path d="M22 2 11 13"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // MOCK DATA
    // ============================================
    const conversations = [
      {
        id: 1,
        name: "Sarah Johnson",
        avatar: "SJ",
        lastMessage: "Thanks for the update! I'll review the proposal and get back to you by tomorrow.",
        time: new Date(Date.now() - 5 * 60 * 1000),
        unread: 2,
        online: true,
        source: "telegram",
        phone: "+1 (555) 123-4567",
        email: "sarah.j@email.com",
        firstContact: "Nov 15, 2024",
        totalMessages: 147
      },
      {
        id: 2,
        name: "Michael Chen",
        avatar: "MC",
        lastMessage: "Can we schedule a call for next week? I have some questions about the integration.",
        time: new Date(Date.now() - 25 * 60 * 1000),
        unread: 0,
        online: true,
        source: "telegram",
        phone: "+1 (555) 234-5678",
        email: "m.chen@company.com",
        firstContact: "Oct 28, 2024",
        totalMessages: 89
      },
      {
        id: 3,
        name: "Emily Davis",
        avatar: "ED",
        lastMessage: "Perfect! The new features look great. Our team is excited to try them out.",
        time: new Date(Date.now() - 2 * 60 * 60 * 1000),
        unread: 0,
        online: false,
        source: "telegram",
        phone: "+1 (555) 345-6789",
        email: "emily.d@startup.io",
        firstContact: "Sep 5, 2024",
        totalMessages: 234
      },
      {
        id: 4,
        name: "Tech Solutions Inc",
        avatar: "TS",
        lastMessage: "We need to discuss the enterprise pricing. Can you send over the details?",
        time: new Date(Date.now() - 5 * 60 * 60 * 1000),
        unread: 1,
        online: false,
        source: "telegram",
        phone: "+1 (555) 456-7890",
        email: "contact@techsolutions.com",
        firstContact: "Aug 12, 2024",
        totalMessages: 56
      },
      {
        id: 5,
        name: "Alex Rodriguez",
        avatar: "AR",
        lastMessage: "Got it, thanks! I'll share this with my team.",
        time: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
        unread: 0,
        online: false,
        source: "telegram",
        phone: "+1 (555) 567-8901",
        email: "alex.r@agency.co",
        firstContact: "Jul 20, 2024",
        totalMessages: 312
      },
      {
        id: 6,
        name: "Design Team",
        avatar: "DT",
        lastMessage: "The mockups are ready for review. Check the shared folder.",
        time: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
        unread: 0,
        online: false,
        source: "telegram",
        phone: "-",
        email: "design@team.com",
        firstContact: "Jun 1, 2024",
        totalMessages: 567
      },
      {
        id: 7,
        name: "Jennifer Smith",
        avatar: "JS",
        lastMessage: "Looking forward to our meeting next Monday!",
        time: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
        unread: 0,
        online: false,
        source: "telegram",
        phone: "+1 (555) 678-9012",
        email: "jen.smith@corp.net",
        firstContact: "May 15, 2024",
        totalMessages: 178
      }
    ];

    const messagesByConversation = {
      1: [
        { id: 1, text: "Hi Sarah! Hope you're doing well.", sent: true, time: new Date(Date.now() - 2 * 60 * 60 * 1000) },
        { id: 2, text: "Hey! Yes, all good here. How's the project coming along?", sent: false, time: new Date(Date.now() - 1.9 * 60 * 60 * 1000) },
        { id: 3, text: "Great progress! We've completed the initial phase and I wanted to share an update.", sent: true, time: new Date(Date.now() - 1.8 * 60 * 60 * 1000) },
        { id: 4, text: "I've attached the proposal document with all the details. Let me know if you have any questions.", sent: true, time: new Date(Date.now() - 1.7 * 60 * 60 * 1000) },
        { id: 5, text: "This looks comprehensive! I appreciate all the work you put into this.", sent: false, time: new Date(Date.now() - 30 * 60 * 1000) },
        { id: 6, text: "Thanks for the update! I'll review the proposal and get back to you by tomorrow.", sent: false, time: new Date(Date.now() - 5 * 60 * 1000) }
      ],
      2: [
        { id: 1, text: "Hi Michael, thanks for reaching out!", sent: true, time: new Date(Date.now() - 3 * 60 * 60 * 1000) },
        { id: 2, text: "No problem! I've been looking into your API documentation.", sent: false, time: new Date(Date.now() - 2.8 * 60 * 60 * 1000) },
        { id: 3, text: "Happy to help with any questions you might have.", sent: true, time: new Date(Date.now() - 2.5 * 60 * 60 * 1000) },
        { id: 4, text: "Can we schedule a call for next week? I have some questions about the integration.", sent: false, time: new Date(Date.now() - 25 * 60 * 1000) }
      ],
      3: [
        { id: 1, text: "Emily, we just pushed the new release with the features you requested!", sent: true, time: new Date(Date.now() - 4 * 60 * 60 * 1000) },
        { id: 2, text: "That's amazing news! Can you give me a quick overview?", sent: false, time: new Date(Date.now() - 3.5 * 60 * 60 * 1000) },
        { id: 3, text: "Sure! We added the dashboard analytics, export functionality, and improved the search.", sent: true, time: new Date(Date.now() - 3 * 60 * 60 * 1000) },
        { id: 4, text: "Perfect! The new features look great. Our team is excited to try them out.", sent: false, time: new Date(Date.now() - 2 * 60 * 60 * 1000) }
      ],
      4: [
        { id: 1, text: "Hello Tech Solutions team!", sent: true, time: new Date(Date.now() - 8 * 60 * 60 * 1000) },
        { id: 2, text: "Hi there! We're interested in your enterprise offering.", sent: false, time: new Date(Date.now() - 7 * 60 * 60 * 1000) },
        { id: 3, text: "We need to discuss the enterprise pricing. Can you send over the details?", sent: false, time: new Date(Date.now() - 5 * 60 * 60 * 1000) }
      ],
      5: [
        { id: 1, text: "Alex, here's the report you asked for.", sent: true, time: new Date(Date.now() - 1.5 * 24 * 60 * 60 * 1000) },
        { id: 2, text: "Got it, thanks! I'll share this with my team.", sent: false, time: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000) }
      ],
      6: [
        { id: 1, text: "Team, please review the latest designs when you get a chance.", sent: true, time: new Date(Date.now() - 2.5 * 24 * 60 * 60 * 1000) },
        { id: 2, text: "The mockups are ready for review. Check the shared folder.", sent: false, time: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000) }
      ],
      7: [
        { id: 1, text: "Jennifer, confirming our meeting for Monday at 2 PM.", sent: true, time: new Date(Date.now() - 3.5 * 24 * 60 * 60 * 1000) },
        { id: 2, text: "Looking forward to our meeting next Monday!", sent: false, time: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000) }
      ]
    };

    // ============================================
    // STATE
    // ============================================
    let selectedConversationId = null;

    // ============================================
    // UTILITY FUNCTIONS
    // ============================================
    function formatTime(date) {
      const now = new Date();
      const diff = now - date;
      const minutes = Math.floor(diff / 60000);
      const hours = Math.floor(diff / 3600000);
      const days = Math.floor(diff / 86400000);

      if (minutes < 1) return 'Just now';
      if (minutes < 60) return `${minutes}m`;
      if (hours < 24) return `${hours}h`;
      if (days < 7) return `${days}d`;
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    }

    function formatMessageTime(date) {
      return date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
    }

    function getInitials(name) {
      return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    }

    // ============================================
    // RENDER FUNCTIONS
    // ============================================
    function renderConversations(filter = '') {
      const list = document.getElementById('conversationsList');
      const filtered = conversations
        .filter(c => c.name.toLowerCase().includes(filter.toLowerCase()))
        .sort((a, b) => b.time - a.time);

      list.innerHTML = filtered.map(conv => `
        <div class="conversation-item ${conv.id === selectedConversationId ? 'active' : ''}"
             onclick="selectConversation(${conv.id})">
          <div class="conversation-avatar-wrapper">
            <div class="conversation-avatar ${conv.online ? 'online' : ''}">${conv.avatar}</div>
          </div>
          <div class="conversation-content">
            <div class="conversation-header">
              <span class="conversation-name">${conv.name}</span>
              <span class="conversation-time">${formatTime(conv.time)}</span>
            </div>
            <div class="conversation-preview">${conv.lastMessage}</div>
            <div class="conversation-meta">
              <span class="conversation-source">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/>
                </svg>
                ${conv.source}
              </span>
              ${conv.unread > 0 ? `<span class="unread-badge">${conv.unread}</span>` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    function renderMessages(conversationId) {
      const container = document.getElementById('messagesContainer');
      const messages = messagesByConversation[conversationId] || [];

      if (messages.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg>
            </div>
            <h3 class="empty-state-title">No messages yet</h3>
            <p class="empty-state-text">Start a conversation by sending a message</p>
          </div>
        `;
        return;
      }

      let html = '';
      let lastDate = null;

      messages.forEach(msg => {
        const msgDate = msg.time.toDateString();
        if (msgDate !== lastDate) {
          const today = new Date().toDateString();
          const yesterday = new Date(Date.now() - 86400000).toDateString();
          let dateLabel = msg.time.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
          if (msgDate === today) dateLabel = 'Today';
          if (msgDate === yesterday) dateLabel = 'Yesterday';

          html += `
            <div class="message-date-divider">
              <span>${dateLabel}</span>
            </div>
          `;
          lastDate = msgDate;
        }

        html += `
          <div class="message ${msg.sent ? 'sent' : 'received'}">
            <div class="message-bubble">${msg.text}</div>
            <div class="message-time">
              ${formatMessageTime(msg.time)}
              ${msg.sent ? '<span class="message-status">✓✓</span>' : ''}
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
      container.scrollTop = container.scrollHeight;
    }

    function updateHeader(conversation) {
      document.getElementById('headerAvatar').textContent = conversation.avatar;
      document.getElementById('headerName').textContent = conversation.name;
      document.getElementById('headerStatus').textContent = conversation.online ? 'Online' : 'Last seen recently';
    }

    function updateContactInfo(conversation) {
      document.getElementById('contactPhone').textContent = conversation.phone;
      document.getElementById('contactEmail').textContent = conversation.email;
      document.getElementById('contactSource').textContent = conversation.source.charAt(0).toUpperCase() + conversation.source.slice(1);
      document.getElementById('contactFirstDate').textContent = conversation.firstContact;
      document.getElementById('contactTotalMessages').textContent = conversation.totalMessages;
    }

    // ============================================
    // EVENT HANDLERS
    // ============================================
    function selectConversation(id) {
      selectedConversationId = id;
      const conversation = conversations.find(c => c.id === id);

      if (conversation) {
        conversation.unread = 0;
        renderConversations(document.getElementById('searchInput').value);
        renderMessages(id);
        updateHeader(conversation);
        updateContactInfo(conversation);
      }
    }

    function sendMessage() {
      const input = document.getElementById('messageInput');
      const text = input.value.trim();

      if (!text || !selectedConversationId) return;

      const newMessage = {
        id: Date.now(),
        text: text,
        sent: true,
        time: new Date()
      };

      if (!messagesByConversation[selectedConversationId]) {
        messagesByConversation[selectedConversationId] = [];
      }

      messagesByConversation[selectedConversationId].push(newMessage);

      // Update conversation
      const conv = conversations.find(c => c.id === selectedConversationId);
      if (conv) {
        conv.lastMessage = text;
        conv.time = new Date();
      }

      input.value = '';
      input.style.height = 'auto';
      document.getElementById('sendBtn').disabled = true;

      renderMessages(selectedConversationId);
      renderConversations(document.getElementById('searchInput').value);

      // Simulate reply after 2 seconds
      setTimeout(() => {
        simulateReply();
      }, 2000);
    }

    function simulateReply() {
      if (!selectedConversationId) return;

      const replies = [
        "Thanks for your message! I'll look into this.",
        "Got it, let me check and get back to you.",
        "Sounds good! I'll follow up on this shortly.",
        "Thanks for the update!",
        "Perfect, I'll review this and respond soon."
      ];

      const reply = {
        id: Date.now(),
        text: replies[Math.floor(Math.random() * replies.length)],
        sent: false,
        time: new Date()
      };

      messagesByConversation[selectedConversationId].push(reply);

      const conv = conversations.find(c => c.id === selectedConversationId);
      if (conv) {
        conv.lastMessage = reply.text;
        conv.time = new Date();
      }

      renderMessages(selectedConversationId);
      renderConversations(document.getElementById('searchInput').value);
    }

    function handleQuickAction(action) {
      const aiChat = document.getElementById('aiChat');
      let response = '';

      switch (action) {
        case 'summarize':
          response = `<strong>Conversation Summary:</strong><br><br>
            This conversation involves project updates and proposal review. Key points:
            <ul style="margin-top: 8px; padding-left: 20px;">
              <li>Initial project phase completed</li>
              <li>Proposal document shared</li>
              <li>Awaiting feedback by tomorrow</li>
            </ul>`;
          break;
        case 'draft':
          response = `<strong>Suggested Reply:</strong><br><br>
            "Hi! Thank you for reviewing the proposal. I'm available for a call anytime this week if you'd like to discuss any points in detail. Please let me know what works best for you."`;
          break;
        case 'sentiment':
          response = `<strong>Sentiment Analysis:</strong><br><br>
            <span style="color: var(--success);">● Positive</span><br><br>
            The conversation tone is professional and constructive. The contact seems engaged and appreciative of the work being done. No concerns or negative indicators detected.`;
          break;
        case 'tasks':
          response = `<strong>Action Items:</strong><br><br>
            <ul style="margin-top: 8px; padding-left: 20px;">
              <li>✓ Share proposal document (completed)</li>
              <li>□ Wait for feedback by tomorrow</li>
              <li>□ Schedule follow-up call if needed</li>
            </ul>`;
          break;
        case 'help':
          response = `I can help you with:
            <ul style="margin-top: 8px; padding-left: 20px;">
              <li><strong>Summarize</strong> - Get a quick overview of the conversation</li>
              <li><strong>Draft replies</strong> - Generate professional responses</li>
              <li><strong>Sentiment analysis</strong> - Understand customer mood</li>
              <li><strong>Action items</strong> - Extract tasks and to-dos</li>
            </ul>
            <br>Just click a quick action or ask me anything!`;
          break;
      }

      const messageDiv = document.createElement('div');
      messageDiv.className = 'ai-message';
      messageDiv.innerHTML = response;
      aiChat.appendChild(messageDiv);

      document.getElementById('assistantContent').scrollTop = document.getElementById('assistantContent').scrollHeight;
    }

    function sendAssistantMessage() {
      const input = document.getElementById('assistantInput');
      const text = input.value.trim();

      if (!text) return;

      const aiChat = document.getElementById('aiChat');

      // Add user message
      const userDiv = document.createElement('div');
      userDiv.className = 'ai-message user';
      userDiv.textContent = text;
      aiChat.appendChild(userDiv);

      input.value = '';

      // Simulate AI response
      setTimeout(() => {
        const responseDiv = document.createElement('div');
        responseDiv.className = 'ai-message';
        responseDiv.innerHTML = `I understand you're asking about "${text}". Let me help you with that. Based on the current conversation context, I can provide insights or draft a response. What would you like me to focus on?
          <div class="ai-suggestions">
            <span class="ai-suggestion" onclick="handleQuickAction('draft')">Draft a reply</span>
            <span class="ai-suggestion" onclick="handleQuickAction('summarize')">Summarize</span>
          </div>`;
        aiChat.appendChild(responseDiv);
        document.getElementById('assistantContent').scrollTop = document.getElementById('assistantContent').scrollHeight;
      }, 1000);
    }

    // ============================================
    // RESIZER FUNCTIONALITY
    // ============================================
    function initResizer(resizerId, leftPanelId, direction) {
      const resizer = document.getElementById(resizerId);
      const leftPanel = document.getElementById(leftPanelId);

      let startX, startWidth;

      resizer.addEventListener('mousedown', (e) => {
        startX = e.clientX;
        startWidth = leftPanel.offsetWidth;
        resizer.classList.add('active');

        document.addEventListener('mousemove', resize);
        document.addEventListener('mouseup', stopResize);
      });

      function resize(e) {
        const diff = direction === 'left' ? e.clientX - startX : startX - e.clientX;
        const newWidth = startWidth + diff;
        const minWidth = parseInt(getComputedStyle(leftPanel).minWidth) || 200;
        const maxWidth = parseInt(getComputedStyle(leftPanel).maxWidth) || 600;

        if (newWidth >= minWidth && newWidth <= maxWidth) {
          leftPanel.style.width = newWidth + 'px';
        }
      }

      function stopResize() {
        resizer.classList.remove('active');
        document.removeEventListener('mousemove', resize);
        document.removeEventListener('mouseup', stopResize);
      }
    }

    // ============================================
    // AUTO-RESIZE TEXTAREA
    // ============================================
    function autoResizeTextarea(textarea) {
      textarea.style.height = 'auto';
      textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
    }

    // ============================================
    // INITIALIZATION
    // ============================================
    document.addEventListener('DOMContentLoaded', () => {
      // Render conversations
      renderConversations();

      // Select first conversation by default
      if (conversations.length > 0) {
        selectConversation(conversations[0].id);
      }

      // Search functionality
      document.getElementById('searchInput').addEventListener('input', (e) => {
        renderConversations(e.target.value);
      });

      // Message input
      const messageInput = document.getElementById('messageInput');
      const sendBtn = document.getElementById('sendBtn');

      messageInput.addEventListener('input', () => {
        autoResizeTextarea(messageInput);
        sendBtn.disabled = !messageInput.value.trim();
      });

      messageInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });

      sendBtn.addEventListener('click', sendMessage);

      // Assistant input
      const assistantInput = document.getElementById('assistantInput');
      const assistantSendBtn = document.getElementById('assistantSendBtn');

      assistantInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          sendAssistantMessage();
        }
      });

      assistantSendBtn.addEventListener('click', sendAssistantMessage);

      // Initialize resizers
      initResizer('resizer1', 'conversationsPanel', 'left');
      initResizer('resizer2', 'assistantPanel', 'right');
    });
  </script>
</body>
</html>
